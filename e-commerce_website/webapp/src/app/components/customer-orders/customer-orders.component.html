<!-- Order Card -->
<!-- Added `mt-4` to move card down -->
<div class="card shadow-lg rounded-4 p-4 mb-4 mt-4 mx-auto border-0" style="max-width: 1200px;" *ngFor="let order of orders; let i = index">


  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h3 class="mb-1 text-muted">Order ID: <span class="text-dark fw-semibold">{{ order._id }}</span></h3>
      <p class="mb-0 text-muted">Date: <strong>{{ order.date | date: 'medium' }}</strong></p>
    </div>
    <span class="badge bg-info text-dark px-3 py-2">
      Status: {{ order.status }}
    </span>

    

  </div>

 
<!-- Payment Type -->
<div class="text-center mb-3">
  <span class="badge bg-dark-subtle text-dark fs-6 px-4 py-2 rounded-pill">
    Payment: 
    <ng-container [ngSwitch]="order.paymentType">
      <span *ngSwitchCase="'cash'">ğŸ’µ Cash on Delivery</span>
      <span *ngSwitchCase="'cod'">ğŸ’µ Cash on Delivery</span>
      <span *ngSwitchCase="'upi'">ğŸ“± UPI</span>
      <span *ngSwitchCase="'online'">ğŸ’³ Online Payment</span>
      <span *ngSwitchDefault>â“ Unknown</span>
    </ng-container>
  </span>
</div>



  <!-- Address -->
  <div class="bg-light p-3 rounded mb-3">
    <h3 class="text-primary mb-2">ğŸ“ Shipping Address</h3>
    <div *ngIf="editingAddressId !== order._id">
      <p class="mb-2">{{ order.address.address1 }}, {{ order.address.city }} - {{ order.address.pincode }}</p>
      <button class="btn btn-sm btn-outline-primary" (click)="editAddress(order._id!)">
        âœï¸ Edit Address
      </button>
    </div>

    <!-- Edit Address Form -->
    <div *ngIf="editingAddressId === order._id">
      <input type="text" class="form-control mb-2" placeholder="Address Line" [(ngModel)]="updatedAddress.address1">
      <input type="text" class="form-control mb-2" placeholder="City" [(ngModel)]="updatedAddress.city">
      <input type="text" class="form-control mb-2" placeholder="Pincode" [(ngModel)]="updatedAddress.pincode">
      <div>
        <button class="btn btn-sm btn-success me-2" (click)="submitAddress(order._id!)">ğŸ’¾ Save</button>
        <button class="btn btn-sm btn-secondary" (click)="cancelEditAddress()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Order Info -->
  <h3 class="text-primary">ğŸ›’ Order #{{ i + 1 }}</h3>
  <p class="text-muted">Total Items: {{ order.items.length }}</p>

  <!-- Items -->
  <div class="card-body p-0">
    <div class="row border-top pt-3" *ngFor="let item of order.items">
      <div class="col-md-3 mb-3 mb-md-0">
        <img [src]="'http://localhost:3000/' + item.product.images[0] || 'https://via.placeholder.com/150'" alt="Product Image" class="img-fluid rounded shadow-sm">
      </div>
      <div class="col-md-9">
        <h3 class="fw-semibold">{{ item.product.name }}</h3>
        <p class="text-muted mb-1">
          <span class="text-decoration-line-through text-danger">â‚¹{{ item.product.price }}</span>
          <strong class="text-success ms-2">â‚¹{{ getSellingPrice(item.product) }}</strong>
          <span class="badge bg-warning text-dark ms-2">{{ item.product.discount }}% OFF</span>
        </p>
        <p class="mb-0">Quantity: <strong>{{ item.quantity }}</strong></p>
      </div>
    </div>
  </div>

  <!-- Cancel Section -->
  <div *ngIf="isPending(order.status)" class="mt-4">
    <button class="btn btn-danger" (click)="confirmCancel(order._id!)"> Cancel Order</button>

    <div *ngIf="cancelingOrderId === order._id" class="mt-3">
      <textarea class="form-control" [(ngModel)]="cancelReason" rows="2" placeholder="Enter cancellation reason..."></textarea>
      <div class="mt-2 text-end">
        <button class="btn btn-sm btn-warning me-2" (click)="cancelOrder()">Submit</button>
        <button class="btn btn-sm btn-secondary" (click)="cancelCancel()">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Back to Home -->
<div class="text-center mt-5">
  <a routerLink="/" class="btn btn-outline-primary px-4 py-2 rounded-pill">
    ğŸ  Back to Home
  </a>
</div>
